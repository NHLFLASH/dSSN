#!/bin/bash

set -e

trap "pkill -P $$" EXIT

GIT_BASE_DIR=`git rev-parse --show-toplevel`
cd $GIT_BASE_DIR

ADDRESS_1=30820122300d06092a864886f70d01010105000382010f003082010a0282010100d856de8d1b7cc124f76d27917120fe1838aa78e2e349dbc7833fbbc94e0a7f2d620db5a28c44618d7ea73975f278f620b69f4ad8b9f84bb6d74ff2738d14c730a80f8702d545277a8d64aa835aa41535bb771756225fff07434a18d3d4ad2a3c505ceba3db941a052fde1482563bb092621b05193b532e13f919e4f8a1adb91676d2a85f1c713cf2e7ee974bd612862d21ca561f9f68e8ce10258bef2ed5190afa3ef5a87492bc8d736f19f99bdfcbc6b12b75c7aaf2239c91063327923deb1d05ded8f3af5548194669462f2b3c7ff00878f4a8cd4dc2f617147a282f92c83111363484aa1f031f68a472e83dfd283f7b1df6b87e50e049bcbe780d241d676b0203010001

ADDRESS_2=30820122300d06092a864886f70d01010105000382010f003082010a02820101009e331436185ff03ab5c105d99d78e62661a7c07d6150a07fa7ea608a7c8e3ec561cb08d3a43c2659190f22d952f67eb4deb36d2fe406e2abb990b00412592bb827700dba9524760dd25912ef10749e11df1ddf2614f62b843e19acb6c77dc25dbf15ef1fa6d5e5ca8a8c1bb35aeed007384521bf3c85a74156331944aa937e0333ef77fcbf30c0481c52ae7d59932feb23afcfa1bcd0214671f41438ebb8bb4a98c64a89ca088db7b3a29363309aa612c1a579d3980f254a795a4b296fa131ed3f25b4eaae8b92db4321e1788b8f7945e4efdade5528452a36880cd9249daf1e51da3432eb22f8bfde6a33bcb5bee0e3afc2140508ea00c8135ba9bb04b969510203010001


MASTERNODE="true" PORT="5003" python blockchain_node.py &
sleep 2

MASTERNODE="true" PORT="5004" python blockchain_node.py &
sleep 2

curl -XPOST -H "Content-Type: application/json" http://localhost:5003/nodes/register \
     -d '{"nodes":["http://localhost:5004"]}'

curl -XPOST -H "Content-Type: application/json" http://localhost:5004/nodes/register \
     -d '{"nodes":["http://localhost:5003"]}'

wait
